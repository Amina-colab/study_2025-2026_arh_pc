%include 'in_out.asm'
 
SECTION .data
    msg DB 'Введите значение переменной x: ', 0
    rem DB 'Результат: ', 0
 
SECTION .bss
    x RESB 80          ; резервируем 80 байт для ввода
 
SECTION .text
    GLOBAL _start
 
_start:
    ; Запрос на ввод значения x
    mov eax, msg       ; загружаем адрес сообщения
    call sprint        ; выводим сообщение
 
    mov ecx, x        ; указываем адрес для ввода
    mov edx, 80       ; размер буфера
    call sread        ; читаем ввод пользователя
 
    ; Преобразование строки в число (атрибут atoi необходимо реализовать)
    mov eax, x        ; загружаем адрес строки
    call atoi         ; преобразуем строку в целое число
    ; Теперь в eax у нас значение x в виде числа
 
    ; Вычисление y = (2 + x)^2
    add eax, 2        ; прибавляем 2 к x
    mov ebx, eax      ; сохраняем (2 + x) в ebx для дальнейших вычислений
    mul ebx           ; умножаем (2 + x) на (2 + x)
    
    ; Результат находится в eax
    mov edi, eax      ; сохраняем результат в edi для последующего вывода
 
    ; Вывод результата
    mov eax, rem      ; загружаем адрес строки результата
    call sprint       ; выводим сообщение о результате
    mov eax, edi      ; загружаем результат в eax
    call iprint       ; выводим результат

    mov eax, 1        ; системный вызов для выхода
    xor ebx, ebx      ; код возврата 0
    int 0x80          ; вызов ядра
